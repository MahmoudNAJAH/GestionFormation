@using System.Configuration;

@model GestionFormation.Models.DirectoryModel

@if (Model.DirPath != null)
{
    <h3>Liste des dossiers et fichier de cette SessionDeCursus</h3>


    foreach (var item in Model.Directories)
    {
        @*@Html.ActionLink(item.Split('\\')[item.Split('\\').Length - 1], "Details", new { dirPath = item })*@

        @*@Ajax.ActionLink(
                    item.Split('\\')[item.Split('\\').Length - 1],                      // texte à afficher
                    "Details/" + $"{item}",                                             // Action
                    "PartageFichier",                                                   // Controller

                    // les options
                    new AjaxOptions
                    {
                        UpdateTargetId = "Details",           // id de l'élément du DOM à modifier
                        InsertionMode = InsertionMode.Replace,  // stratégie de remplissage de la cible du DOM
                        HttpMethod = "GET"                      // Méthode HTTP
                    }
            )*@

        <button onclick="RefreshDetails(@(Path.Combine(Model.DirPath,item)))">
            @*<img src="~/Images/folder.png" alt="" />*@
            <span>@item</span>
        </button>
    }

    foreach (var item in Model.Files)
    {
        @*@Html.ActionLink(item.Split('\\')[item.Split('\\').Length - 1], "Download", new { fileName = item })*@

        @*<a>
                <img src="~/Images/file.png" />
                <span>@item.Split('\\')[item.Split('\\').Length - 1]</span>
            </a>*@
    }


    <div>
        @using (Html.BeginForm("CreateDirectory", "PartageFichier", FormMethod.Get))
        {
            <input type="hidden" name="dirPath" id="dirPath" value="@Model.DirPath" />
            <input type="text" name="dirName" id="dirName" />
            <button type="submit">Créer le Dossier</button>
        }
    </div>
    <div>
        @using (Html.BeginForm("CreateFile", "PartageFichier", FormMethod.Post, new { enctype = "multipart/form-data" }))
        {
            @Html.AntiForgeryToken();
            <input type="hidden" name="dirPath" id="dirPath" value="@Model.DirPath" />
            <input type="file" name="myFile" id="myFile" />
            <button type="submit">Déposer le fichier</button>
        }
    </div>

}
@*else
    {
        <div>
            pas de répertoire
        </div>
    }*@

